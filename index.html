<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expert-Amort PRO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .collapsible-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .collapsible-content.active { max-height: 1000px; }
    </style>
</head>
<body class="bg-slate-50 p-4 font-sans text-slate-800">

    <div class="max-w-4xl mx-auto">
        <header class="mb-6 text-center">
            <h1 class="text-3xl font-extrabold text-slate-900">Expert-Amort <span class="text-blue-600">PRO</span></h1>
            <p class="text-slate-500 italic text-sm">Pr√©cision comptable & fiscale</p>
        </header>

        <section class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 mb-4">
            <div class="flex items-center gap-2 mb-4 border-b pb-2">
                <span class="bg-blue-600 text-white w-6 h-6 flex items-center justify-center rounded-full text-xs font-bold">1</span>
                <h2 class="text-lg font-bold text-slate-700">Donn√©es de l'Investissement</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-2">
                    <label class="block text-xs font-bold uppercase text-slate-400">Acquisition & Mise en service</label>
                    <input type="date" id="dateAcq" class="w-full border p-2 rounded text-sm mb-2">
                    <input type="date" id="dateService" class="w-full border p-2 rounded text-sm" placeholder="Mise en service">
                    <div class="flex items-center gap-2 mt-3 p-2 bg-blue-50 rounded border border-blue-100">
                        <input type="checkbox" id="isVehicule" class="w-4 h-4">
                        <label for="isVehicule" class="text-xs text-blue-900 font-medium">V√©hicule de tourisme (TVA +)</label>
                    </div>
                </div>
                <div class="space-y-2">
                    <label class="block text-xs font-bold uppercase text-slate-400">Valeurs financi√®res</label>
                    <input type="number" id="montantHT" placeholder="Montant HT" class="w-full border p-2 rounded text-sm font-bold text-blue-700">
                    <div class="flex items-center gap-2">
                        <span class="text-xs text-slate-500 w-1/3">Valeur R√©sid. :</span>
                        <input type="number" id="valeurResiduelle" value="0" class="w-2/3 border p-2 rounded text-sm text-right">
                    </div>
                </div>
            </div>
        </section>

        <section class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 mb-4">
            <div class="flex items-center gap-2 mb-4 border-b pb-2">
                <span class="bg-emerald-600 text-white w-6 h-6 flex items-center justify-center rounded-full text-xs font-bold">2</span>
                <h2 class="text-lg font-bold text-slate-700">Param√®tres d'Amortissement</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="space-y-3 p-3 bg-slate-50 rounded-lg">
                    <h3 class="text-sm font-bold text-emerald-700 underline uppercase">üìä √âconomique (Compta)</h3>
                    <div>
                        <label class="block text-[10px] font-bold">TYPE</label>
                        <select id="typeEco" class="w-full border p-1 rounded text-sm">
                            <option value="lineaire">Lin√©aire</option>
                            <option value="degressif">D√©gressif</option>
                            <option value="variable">Variable (Unit√©s d'≈ìuvre)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold">DUR√âE (ann√©es)</label>
                        <input type="number" id="dureeEco" value="5" class="w-full border p-1 rounded text-sm">
                    </div>
                </div>
                <div class="space-y-3 p-3 bg-slate-50 rounded-lg border-l-2 border-emerald-200">
                    <h3 class="text-sm font-bold text-emerald-700 underline uppercase">‚öñÔ∏è Fiscal</h3>
                    <div>
                        <label class="block text-[10px] font-bold">TYPE</label>
                        <select id="typeFisc" class="w-full border p-1 rounded text-sm">
                            <option value="lineaire">Lin√©aire</option>
                            <option value="degressif" selected>D√©gressif</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold">DUR√âE (ann√©es)</label>
                        <input type="number" id="dureeFisc" value="5" class="w-full border p-1 rounded text-sm">
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-6">
            <button onclick="toggleCession()" class="w-full flex items-center justify-between bg-white p-4 rounded-xl shadow-sm border border-slate-200 hover:bg-slate-50 transition-all">
                <div class="flex items-center gap-2 text-slate-700">
                    <span id="cessionBadge" class="bg-slate-300 text-white w-6 h-6 flex items-center justify-center rounded-full text-xs font-bold">3</span>
                    <h2 class="text-lg font-bold">Donn√©es de Cession <span class="text-xs font-normal text-slate-400 ml-2">(Optionnel)</span></h2>
                </div>
                <span id="cessionArrow" class="text-xl">‚ûï</span>
            </button>
            <div id="cessionContent" class="collapsible-content bg-white border-x border-b border-slate-200 rounded-b-xl mx-2 shadow-inner">
                <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-bold text-red-700">DATE DE CESSION</label>
                        <input type="date" id="dateCession" class="w-full border p-2 rounded text-sm border-red-100">
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold text-slate-400">EXERCICE DE CESSION</label>
                        <div class="flex gap-1">
                            <input type="date" id="cessionBilanDebut" class="w-1/2 border p-1 rounded text-[10px] bg-gray-50">
                            <input type="date" id="cessionBilanFin" class="w-1/2 border p-1 rounded text-[10px] bg-gray-50">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="bg-slate-900 text-white p-6 rounded-2xl shadow-xl flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="text-center md:text-left">
                <span class="text-slate-400 text-[10px] uppercase font-bold tracking-widest">Base Amortissable</span>
                <div id="resultatBase" class="text-3xl font-black">0,00 ‚Ç¨</div>
            </div>
            <button class="bg-emerald-600 hover:bg-emerald-500 text-white px-10 py-4 rounded-xl font-bold shadow-lg transition-transform active:scale-95">
                Calculer le Tableau
            </button>
        </div>
    </div>

    <script>
        function toggleCession() {
            const content = document.getElementById('cessionContent');
            const arrow = document.getElementById('cessionArrow');
            const badge = document.getElementById('cessionBadge');
            content.classList.toggle('active');
            arrow.innerText = content.classList.contains('active') ? "‚ûñ" : "‚ûï";
            badge.className = content.classList.contains('active') ? 
                "bg-red-500 text-white w-6 h-6 flex items-center justify-center rounded-full text-xs font-bold" : 
                "bg-slate-300 text-white w-6 h-6 flex items-center justify-center rounded-full text-xs font-bold";
        }

        const dateAcq = document.getElementById('dateAcq');
        const montantHT = document.getElementById('montantHT');
        const isVehicule = document.getElementById('isVehicule');
        const valRes = document.getElementById('valeurResiduelle');
        const resultatBase = document.getElementById('resultatBase');
        const dateCession = document.getElementById('dateCession');

        dateAcq.addEventListener('change', (e) => {
            const d = e.target.value;
            if (!d) return;
            document.getElementById('dateService').value = d;
            calculerBase();
        });

        dateCession.addEventListener('change', (e) => {
            const d = e.target.value;
            if (!d) return;
            const year = new Date(d).getFullYear();
            document.getElementById('cessionBilanDebut').value = `${year}-01-01`;
            document.getElementById('cessionBilanFin').value = `${year}-12-31`;
        });

        function calculerBase() {
            let mtHT = parseFloat(montantHT.value) || 0;
            let vr = parseFloat(valRes.value) || 0;
            let tva = isVehicule.checked ? 1.20 : 1.00;
            let base = (mtHT * tva) - vr;
            resultatBase.innerText = new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR' }).format(base);
        }

        [montantHT, isVehicule, valRes].forEach(el => el.addEventListener('input', calculerBase));
    </script>
</body>
</html>
